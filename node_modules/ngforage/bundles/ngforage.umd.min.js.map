{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","ng://ngforage/lib/cache/cached-item-impl.class.ts","ng://ngforage/lib/imports/localforage.ts","ng://ngforage/lib/misc/driver.enum.ts","ng://ngforage/lib/misc/injection-tokens.ts","ng://ngforage/lib/config/ng-forage-config.service.ts","ng://ngforage/lib/instance-factory/instance-factory.service.ts","ng://ngforage/lib/config/base-configurable-impl.service.ts","ng://ngforage/lib/main/ng-forage.service.ts","ng://ngforage/lib/cache/ng-forage-cache.service.ts","ng://ngforage/lib/dedicated/ng-forage-cache-dedicated.class.ts","ng://ngforage/lib/dedicated/ng-forage-dedicated.class.ts","ng://ngforage/lib/dedicated/dedicated-instance-factory.service.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__values","o","s","Symbol","iterator","m","i","call","length","next","value","done","TypeError","CachedItemImpl","data","expiryTime","expires","Date","defineProperty","expiresIn","Math","max","getTime","now","toJSON","expired","hasData","toString","JSON","stringify","localForage","lf","lf['default']","Driver","INDEXED_DB","LOCAL_STORAGE","WEB_SQL","_b","INDEXEDDB","LOCALSTORAGE","WEBSQL","_c","freeze","DEFAULT_CONFIG","InjectionToken","$defaultConfig","NgForageConfig","conf","cacheTime","description","driver","name","size","storeName","version","configure","t","v","slice","opts","assign","defineDriver","spec","config","Injectable","args","providedIn","Optional","type","Inject","stores","conf$","InstanceFactory","getInstance","cfg","hash","isArray","sort","join","getHash","createInstance","store$","BaseConfigurableImpl","instanceFactory","storeNeedsRecalc","baseConfig","fact","finalConfig","decorators","NgForage","_super","store","clear","clone","inst","getItem","key","iterate","iteratee","index","keys","ready","removeItem","setItem","supports","calculateCacheKeys","mainKey","expiry","toCachedItem","r","head","toVoid","NgForageCache","getCached","dataPromise","expiryPromise","Promise","all","then","removeCached","setCached","NgForageCacheDedicated","NgForageDedicated","if$","DedicatedInstanceFactory","instFact","createCache","createNgForage"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import {CachedItem} from './cached-item';\n\n/** @internal */\nexport class CachedItemImpl<T> implements CachedItem<T> {\n\n  public readonly expires: Date;\n\n  public constructor(public readonly data: T, expiryTime: number) {\n    this.expires = new Date(typeof <any>expiryTime === 'number' ? expiryTime : 0);\n  }\n\n  public get expired(): boolean {\n    const value = this.expiresIn === 0;\n    if (value) {\n      Object.defineProperty(this, 'expired', {value});\n    }\n\n    return value;\n  }\n\n  public get expiresIn(): number {\n    const value = Math.max(0, this.expires.getTime() - Date.now());\n    if (!value) {\n      Object.defineProperty(this, 'expiresIn', {value});\n    }\n\n    return value;\n  }\n\n  public get hasData(): boolean {\n    const value = this.data != null; //tslint:disable-line:triple-equals\n    Object.defineProperty(this, 'hasData', {value});\n\n    return value;\n  }\n\n  public toJSON(): CachedItem<T> {\n    return {\n      data: this.data,\n      expired: this.expired,\n      expires: this.expires,\n      expiresIn: this.expiresIn,\n      hasData: this.hasData\n    };\n  }\n\n  public toString(): string {\n    return JSON.stringify(this.toJSON());\n  }\n}\n","import * as lf from 'localforage';\n\n/** @internal */\nexport const localForage: LocalForage = 'defineDriver' in lf ? lf : lf['default'];\n","import {localForage as lf} from '../imports/localforage';\n\n/** ngforage abstraction over localforage driver names */\nenum Driver {\n  /** The IndexedDB driver */\n  INDEXED_DB = <any>lf.INDEXEDDB,\n  /** The localStorage driver */\n  LOCAL_STORAGE = <any>lf.LOCALSTORAGE,\n  /** The WebSQL driver */\n  WEB_SQL = <any>lf.WEBSQL\n}\n\n// Clean up after Typescript's two-way enum transpilig\nfor (const d of [lf.INDEXEDDB, lf.LOCALSTORAGE, lf.WEBSQL]) {\n  delete Driver[d];\n}\n\nObject.freeze(Driver);\n\nexport {Driver};\n","import {InjectionToken} from '@angular/core';\nimport {NgForageOptions} from '../config/ng-forage-options';\n\n/** Default ngforage configuration */\nexport const DEFAULT_CONFIG = new InjectionToken<NgForageOptions>('Default NgForage config');\n","import {Inject, Injectable, Optional} from '@angular/core';\nimport 'localforage';\nimport {localForage as lf} from '../imports/localforage';\nimport {DriverType} from '../misc/driver-type.type';\nimport {Driver} from '../misc/driver.enum';\nimport {DEFAULT_CONFIG} from '../misc/injection-tokens';\nimport {BaseConfigurable} from './base-configurable';\nimport {CacheConfigurable} from './cache-configurable';\nimport {NgForageOptions} from './ng-forage-options';\n\n/** @internal */\nconst $defaultConfig: unique symbol = Symbol('Default Config');\n\n/**\n * Global/default configuration\n */\n@Injectable({providedIn: 'root'})\nexport class NgForageConfig implements BaseConfigurable, CacheConfigurable {\n\n  /** @internal */\n  private readonly [$defaultConfig]: NgForageOptions;\n\n  public constructor(@Optional() @Inject(DEFAULT_CONFIG) conf: NgForageOptions) {\n    this[$defaultConfig] = {\n      cacheTime: 300000,\n      description: '',\n      driver: [Driver.INDEXED_DB, Driver.WEB_SQL, Driver.LOCAL_STORAGE],\n      name: 'ngForage',\n      size: 4980736,\n      storeName: 'ng_forage',\n      version: 1\n    };\n    if (conf) {\n      this.configure(conf);\n    }\n  }\n\n  /**\n   * Cache time in milliseconds\n   * @default 300000\n   */\n  public get cacheTime(): number {\n    return <number>this[$defaultConfig].cacheTime;\n  }\n\n  public set cacheTime(t: number) {\n    this[$defaultConfig].cacheTime = t;\n  }\n\n  /**\n   * Get the compiled configuration\n   */\n  public get config(): NgForageOptions {\n    return {\n      cacheTime: this.cacheTime,\n      description: this.description,\n      driver: this.driver,\n      name: this.name,\n      size: this.size,\n      storeName: this.storeName,\n      version: this.version\n    };\n  }\n\n  /**\n   * A description of the database, essentially for developer usage.\n   * @default\n   */\n  public get description(): string {\n    return <string>this[$defaultConfig].description;\n  }\n\n  public set description(v: string) {\n    this[$defaultConfig].description = v;\n  }\n\n  /**\n   * The preferred driver(s) to use.\n   */\n  public get driver(): DriverType | DriverType[] {\n    if (typeof this[$defaultConfig].driver === 'string') {\n      return <string>this[$defaultConfig].driver;\n    }\n\n    return (<string[]>this[$defaultConfig].driver).slice();\n  }\n\n  public set driver(v: DriverType | DriverType[]) {\n    this[$defaultConfig].driver = v;\n  }\n\n  /**\n   * The name of the database. May appear during storage limit prompts. Useful to use the name of your app here.\n   * In localStorage, this is used as a key prefix for all keys stored in localStorage.\n   * @default ngForage\n   */\n  public get name(): string {\n    return <string>this[$defaultConfig].name;\n  }\n\n  public set name(v: string) {\n    this[$defaultConfig].name = v;\n  }\n\n  /**\n   * The size of the database in bytes. Used only in WebSQL for now.\n   * @default 4980736\n   */\n  public get size(): number {\n    return <number>this[$defaultConfig].size;\n  }\n\n  public set size(v: number) {\n    this[$defaultConfig].size = v;\n  }\n\n  /**\n   * The name of the datastore.\n   * In IndexedDB this is the dataStore,\n   * in WebSQL this is the name of the key/value table in the database.\n   * Must be alphanumeric, with underscores.\n   * Any non-alphanumeric characters will be converted to underscores.\n   * @default ng_forage\n   */\n  public get storeName(): string {\n    return <string>this[$defaultConfig].storeName;\n  }\n\n  public set storeName(v: string) {\n    this[$defaultConfig].storeName = v;\n  }\n\n  /**\n   * The version of your database. May be used for upgrades in the future; currently unused.\n   * @default 1.0\n   */\n  public get version(): number {\n    return <number>this[$defaultConfig].version;\n  }\n\n  public set version(v: number) {\n    this[$defaultConfig].version = v;\n  }\n\n  /**\n   * Bulk-set configuration options\n   * @param opts The configuration\n   */\n  public configure(opts: NgForageOptions): this {\n    opts = opts || {};\n\n    if (opts.driver && (<any[]>opts.driver).slice) {\n      opts.driver = (<DriverType[]>opts.driver).slice();\n    }\n\n    Object.assign(this[$defaultConfig], opts);\n\n    return this;\n  }\n\n  /**\n   * Define a driver\n   *\n   * You’ll want to make sure you accept a callback argument and that you pass the same arguments to callbacks as the\n   * default drivers do. You’ll also want to resolve or reject promises.\n   * Check any of the {@link https://github.com/mozilla/localForage/tree/master/src/drivers default drivers}\n   * for an idea of how to implement your own, custom driver.\n   * @param spec Driver spec\n   */\n  public defineDriver(spec: LocalForageDriver): Promise<void> {\n    return lf.defineDriver(spec);\n  }\n\n  /** @internal */\n  public toJSON(): NgForageOptions {\n    return this.config;\n  }\n\n  public toString(): string {\n    return JSON.stringify(this.toJSON());\n  }\n}\n","import {Injectable} from '@angular/core';\nimport 'localforage';\nimport {NgForageConfig} from '../config/ng-forage-config.service';\nimport {NgForageOptions} from '../config/ng-forage-options';\nimport {localForage as lf} from '../imports/localforage';\nimport {DriverType} from '../misc/driver-type.type';\n\n/** @internal */\ninterface InstanceMap {\n  [hash: string]: LocalForage;\n}\n\n/** @internal */\nconst stores: InstanceMap = {};\n\n/** @internal */\nfunction getDriverString(driver?: DriverType | DriverType[]): string {\n  if (!driver) {\n    return '';\n  } else if (Array.isArray(driver)) {\n    return driver.slice().sort().join(',');\n  } else {\n    return <string>driver;\n  }\n}\n\n/** @internal */\nfunction getHash(cfg: NgForageOptions): string {\n  return [\n    getDriverString(cfg.driver),\n    cfg.name,\n    cfg.size,\n    cfg.storeName,\n    cfg.version,\n    cfg.description,\n    cfg.cacheTime\n  ].join('|');\n}\n\n/** @internal */\nconst conf$ = Symbol('Config');\n\n/**\n * Creates localForage instances\n */\n@Injectable({providedIn: 'root'})\nexport class InstanceFactory {\n\n  /** @internal */\n  public constructor(conf: NgForageConfig) {\n    this[conf$] = conf;\n  }\n\n  public getInstance(cfg: NgForageOptions): LocalForage {\n    cfg = Object.assign({}, this[conf$].config, cfg || {});\n    const hash = getHash(cfg);\n\n    if (!stores[hash]) {\n      stores[hash] = lf.createInstance(cfg);\n    }\n\n    return stores[hash];\n  }\n}\n","import { Inject, Injectable } from '@angular/core';\nimport 'localforage';\nimport {InstanceFactory} from '../instance-factory/instance-factory.service';\nimport {DriverType} from '../misc/driver-type.type';\nimport {BaseConfigurable} from './base-configurable';\nimport {NgForageConfig} from './ng-forage-config.service';\nimport {NgForageOptions} from './ng-forage-options';\n\n/** @internal */\nconst store$: unique symbol = Symbol('Store');\n\n/**\n * Abstract service-level configuration layer for NgForage\n */\n@Injectable()\nexport abstract class BaseConfigurableImpl implements BaseConfigurable {\n\n  /** @internal */\n  protected readonly baseConfig: NgForageConfig;\n\n  /** @internal */\n  protected readonly config: NgForageOptions = {};\n\n  /** @internal */\n  protected readonly fact: InstanceFactory;\n\n  /** @internal */\n  protected storeNeedsRecalc = true;\n\n  /** @internal */\n  public constructor(\n    @Inject(NgForageConfig) config: NgForageConfig,\n    @Inject(InstanceFactory) instanceFactory: InstanceFactory\n  ) {\n    this.baseConfig = config;\n    this.fact = instanceFactory;\n  }\n\n  /**\n   * A description of the database, essentially for developer usage.\n   * @default \"\"\n   */\n  public get description(): string {\n    return this.config.description || this.baseConfig.description;\n  }\n\n  public set description(v: string) {\n    this.config.description = v;\n    this.storeNeedsRecalc = true;\n  }\n\n  /**\n   * The preferred driver(s) to use.\n   * @default IndexedDB, WebSQL and localStorage\n   */\n  public get driver(): DriverType | DriverType[] {\n    return this.config.driver || this.baseConfig.driver;\n  }\n\n  public set driver(v: DriverType | DriverType[]) {\n    this.config.driver = v;\n    this.storeNeedsRecalc = true;\n  }\n\n  /**\n   * The name of the database. May appear during storage limit prompts. Useful to use the name of your app here.\n   * In localStorage, this is used as a key prefix for all keys stored in localStorage.\n   * @default ngForage\n   */\n  public get name(): string {\n    return this.config.name || this.baseConfig.name;\n  }\n\n  public set name(v: string) {\n    this.config.name = v;\n    this.storeNeedsRecalc = true;\n  }\n\n  /**\n   * The size of the database in bytes. Used only in WebSQL for now.\n   * @default 4980736\n   */\n  public get size(): number {\n    return this.config.size || this.baseConfig.size;\n  }\n\n  public set size(v: number) {\n    this.config.size = v;\n    this.storeNeedsRecalc = true;\n  }\n\n  /**\n   * The name of the datastore.\n   * In IndexedDB this is the dataStore,\n   * in WebSQL this is the name of the key/value table in the database.\n   * Must be alphanumeric, with underscores.\n   * Any non-alphanumeric characters will be converted to underscores.\n   * @default ng_forage\n   */\n  public get storeName(): string {\n    return this.config.storeName || this.baseConfig.storeName;\n  }\n\n  public set storeName(v: string) {\n    this.config.storeName = v;\n    this.storeNeedsRecalc = true;\n  }\n\n  /**\n   * The version of your database. May be used for upgrades in the future; currently unused.\n   * @default 1.0\n   */\n  public get version(): number {\n    return 'version' in this.config ? <number>this.config.version : this.baseConfig.version;\n  }\n\n  public set version(v: number) {\n    this.config.version = v;\n    this.storeNeedsRecalc = true;\n  }\n\n  /** @internal */\n  protected get finalConfig(): NgForageOptions {\n    return Object.assign(\n      {},\n      this.baseConfig.config,\n      this.config\n    );\n  }\n\n  /** @internal */\n  protected get store(): LocalForage {\n    if (this.storeNeedsRecalc || !this[store$]) {\n      this[store$] = this.fact.getInstance(this.finalConfig);\n      this.storeNeedsRecalc = false;\n    }\n\n    return this[store$];\n  }\n\n  /**\n   * Bulk-set configuration options\n   * @param opts The configuration\n   */\n  public configure(opts: NgForageOptions): this {\n    opts = opts || {};\n\n    if (Array.isArray(opts.driver)) {\n      opts.driver = opts.driver.slice();\n    }\n\n    Object.assign(this.config, opts);\n    this.storeNeedsRecalc = true;\n\n    return this;\n  }\n\n  public toJSON(): Partial<NgForageOptions> {\n    return {\n      description: this.description,\n      driver: this.driver,\n      name: this.name,\n      size: this.size,\n      storeName: this.storeName,\n      version: this.version\n    };\n  }\n\n  public toString(): string {\n    return JSON.stringify(this.toJSON());\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {BaseConfigurable} from '../config/base-configurable';\nimport {BaseConfigurableImpl} from '../config/base-configurable-impl.service';\nimport {NgForageOptions} from '../config/ng-forage-options';\nimport {DriverType} from '../misc/driver-type.type';\nimport {Driver} from '../misc/driver.enum';\n\n/**\n * Cache instance\n */\n@Injectable({providedIn: 'root'})\nexport class NgForage extends BaseConfigurableImpl implements BaseConfigurable {\n\n  /**\n   * Returns the name of the driver being used, or null if none can be used.\n   */\n  public get activeDriver(): DriverType {\n    return this.store.driver();\n  }\n\n  /**\n   * Removes every key from the database, returning it to a blank slate.\n   *\n   * clear() will remove <b>every item in the offline store</b>. Use this method with caution.\n   */\n  public clear(): Promise<void> {\n    return this.store.clear();\n  }\n\n  /**\n   * Make a clone of the instance\n   * @param config Optional configuration\n   */\n  public clone(config?: NgForageOptions): NgForage {\n    const inst = new NgForage(this.baseConfig, this.fact);\n    inst.configure(Object.assign(this.finalConfig, config || {}));\n\n    return inst;\n  }\n\n  /**\n   * Gets an item from the storage library.\n   * If the key does not exist, getItem() will return null.\n   * @param key Data key\n   */\n  public getItem<T>(key: string): Promise<T> {\n    return this.store.getItem<T>(key);\n  }\n\n  /**\n   * Iterate over all value/key pairs in datastore.\n   * <i>iteratee</i> is called once for each pair, with the following arguments:\n   * <ol>\n   *   <li>Value</li>\n   *   <li>Key</li>\n   *   <li>iterationNumber - one-based number</li>\n   * </ol>\n   * iterate() supports early exit by returning non undefined value inside iteratorCallback callback.\n   * @param iteratee\n   */\n  public iterate<T, U>(iteratee: (value: T, key: string, iterationNumber: number) => U): Promise<U> {\n    return this.store.iterate(iteratee);\n  }\n\n  /**\n   * Get the name of a key based on its ID.\n   * @param index\n   */\n  public key(index: number): Promise<string> {\n    return this.store.key(index);\n  }\n\n  /**\n   * Get the list of all keys in the datastore.\n   */\n  public keys(): Promise<string[]> {\n    return this.store.keys();\n  }\n\n  /**\n   * Gets the number of keys in the offline store (i.e. its “length”).\n   */\n  public length(): Promise<number> {\n    return this.store.length();\n  }\n\n  /**\n   * Even though localForage queues up all of its data API method calls,\n   * ready() provides a way to determine whether the asynchronous driver initialization process has finished.\n   * That’s useful in cases like when we want to know which driver localForage has settled down using.\n   */\n  public ready(): Promise<void> {\n    return this.store.ready();\n  }\n\n  /**\n   * Removes the value of a key from the offline store.\n   * @param key Data key\n   */\n  public removeItem(key: string): Promise<void> {\n    return this.store.removeItem(key);\n  }\n\n  /**\n   * Saves data to an offline store. You can store the following types of JavaScript objects:\n   * <ul>\n   *  <li>Array</li>\n   *  <li>ArrayBuffer</li>\n   *  <li>Blob</li>\n   *  <li>Float32Array</li>\n   *  <li>Float64Array</li>\n   *  <li>Int8Array</li>\n   *  <li>Int16Array</li>\n   *  <li>Int32Array</li>\n   *  <li>Number</li>\n   *  <li>Object</li>\n   *  <li>Uint8Array</li>\n   *  <li>Uint8ClampedArray</li>\n   *  <li>Uint16Array</li>\n   *  <li>Uint32Array</li>\n   *  <li>String</li>\n   * </ul>\n   * @param key Data key\n   * @param data Data\n   */\n  public setItem<T>(key: string, data: T): Promise<T> {\n    return this.store.setItem<T>(key, data);\n  }\n\n  /**\n   * Check whether the given driver is supported/registered.\n   * @param driver Driver name\n   */\n  public supports(driver: Driver | string): boolean {\n    return this.store.supports(<string>driver);\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {CacheConfigurable} from '../config/cache-configurable';\nimport {NgForageOptions} from '../config/ng-forage-options';\nimport {NgForage} from '../main/ng-forage.service';\nimport {CachedItem} from './cached-item';\nimport {CachedItemImpl} from './cached-item-impl.class';\n\n/** @internal */\ninterface CacheKeys {\n  data: string;\n\n  expiry: string;\n}\n\n/** @internal */\nfunction calculateCacheKeys(mainKey: string): CacheKeys {\n  return {\n    data: `${mainKey}_data`,\n    expiry: `${mainKey}_expiry`\n  };\n}\n\n/** @internal */\nfunction toCachedItem<T>(r: [T, number]): CachedItem<T> {\n  return new CachedItemImpl<T>(r[0], r[1]);\n}\n\n/** @internal */\nfunction head<T>(r: [T, number]) {\n  return r[0];\n}\n\n/** @internal */\n// tslint:disable-next-line:no-empty\nfunction toVoid(): void {\n\n}\n\n/**\n * An extension of {@link NgForage} which adds expiration support\n */\n@Injectable({providedIn: 'root'})\nexport class NgForageCache extends NgForage implements CacheConfigurable {\n\n  /**\n   * Cache time in milliseconds\n   * @default 300000\n   */\n  public get cacheTime(): number {\n    return this.config.cacheTime || this.baseConfig.cacheTime;\n  }\n\n  public set cacheTime(t: number) {\n    this.config.cacheTime = t;\n    this.storeNeedsRecalc = true;\n  }\n\n  /** @inheritDoc */\n  public clone(config?: NgForageOptions): NgForageCache {\n    const inst = new NgForageCache(this.baseConfig, this.fact);\n    inst.configure(Object.assign(this.finalConfig, config || {}));\n\n    return inst;\n  }\n\n  /**\n   * Retrieve data\n   * @param key Data key\n   */\n  public getCached<T>(key: string): Promise<CachedItem<T>> {\n    const keys = calculateCacheKeys(key);\n    const dataPromise = this.getItem<T>(keys.data);\n    const expiryPromise = this.getItem<number>(keys.expiry);\n\n    return Promise.all([dataPromise, expiryPromise]).then(toCachedItem);\n  }\n\n  /**\n   * Remove data\n   * @param key Data key\n   */\n  public removeCached(key: string): Promise<void> {\n    const keys = calculateCacheKeys(key);\n\n    const dataPromise = this.removeItem(keys.data);\n    const expiryPromise = this.removeItem(keys.expiry);\n\n    return Promise.all([dataPromise, expiryPromise]).then(toVoid);\n  }\n\n  /**\n   * Set data\n   * @param key Data key\n   * @param data Data to set\n   * @param [cacheTime] Override cache set in {@link CacheConfigurable#cacheTime global or instance config}.\n   */\n  public setCached<T>(key: string, data: T, cacheTime?: number): Promise<T> {\n    const keys = calculateCacheKeys(key);\n    const expiry = typeof cacheTime === 'number' ? cacheTime : this.cacheTime;\n\n    const dataPromise = this.setItem<T>(keys.data, data);\n    const expiryPromise = this.setItem<number>(keys.expiry, Date.now() + expiry);\n\n    return Promise.all([dataPromise, expiryPromise]).then(head);\n  }\n\n  /** @internal */\n  public toJSON(): NgForageOptions {\n    return Object.assign(super.toJSON() as NgForageOptions, {cacheTime: this.cacheTime});\n  }\n}\n","import {NgForageCache} from '../cache/ng-forage-cache.service';\nimport {NgForageOptions} from '../config/ng-forage-options';\n\n/** @internal */\nexport class NgForageCacheDedicated extends NgForageCache {\n\n  public clone(config?: NgForageOptions): NgForageCache {\n    const inst = new NgForageCacheDedicated(this.baseConfig, this.fact);\n    inst.configure(Object.assign(this.finalConfig, config || {}));\n\n    return inst;\n  }\n}\n","import {NgForageOptions} from '../config/ng-forage-options';\nimport {NgForage} from '../main/ng-forage.service';\n\n/** @internal */\nexport class NgForageDedicated extends NgForage {\n\n  public clone(config?: NgForageOptions): NgForage {\n    const inst = new NgForageDedicated(this.baseConfig, this.fact);\n    inst.configure(Object.assign(this.finalConfig, config || {}));\n\n    return inst;\n  }\n}\n","import {Injectable} from '@angular/core';\nimport {NgForageCache} from '../cache/ng-forage-cache.service';\nimport {NgForageConfig} from '../config/ng-forage-config.service';\nimport {NgForageOptions} from '../config/ng-forage-options';\nimport {InstanceFactory} from '../instance-factory/instance-factory.service';\nimport {NgForage} from '../main/ng-forage.service';\nimport {NgForageCacheDedicated} from './ng-forage-cache-dedicated.class';\nimport {NgForageDedicated} from './ng-forage-dedicated.class';\n\n/** @internal */\nconst conf$: unique symbol = Symbol('NgForageConfig');\n/** @internal */\nconst if$: unique symbol = Symbol('InstanceFactory');\n\n@Injectable({providedIn: 'root'})\nexport class DedicatedInstanceFactory {\n\n  /** @internal */\n  private readonly [conf$]: NgForageConfig;\n\n  /** @internal */\n  private readonly [if$]: InstanceFactory;\n\n  public constructor(conf: NgForageConfig, instFact: InstanceFactory) {\n    this[conf$] = conf;\n    this[if$] = instFact;\n  }\n\n  public createCache(config?: NgForageOptions): NgForageCache {\n    const inst = new NgForageCacheDedicated(this[conf$], this[if$]);\n    if (config) {\n      inst.configure(config);\n    }\n\n    return inst;\n  }\n\n  public createNgForage(config?: NgForageOptions): NgForage {\n    const inst = new NgForageDedicated(this[conf$], this[if$]);\n    if (config) {\n      inst.configure(config);\n    }\n\n    return inst;\n  }\n}\n"]}